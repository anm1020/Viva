<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<title>λ‚΄ μμ•½ λ©λ΅</title>
<style>
table {
	width: 100%;
	border-collapse: collapse;
	margin-top: 1rem;
}

th, td {
	border: 1px solid #ccc;
	padding: .5rem;
}
</style>
</head>
<body>
	<h1>λ‚΄ μμ•½ λ©λ΅</h1>
	<!-- β–¶ ν¬μΈνΈ ν‘μ‹ -->
	<p>
		<strong>λ³΄μ  ν¬μΈνΈ:</strong> <span th:text="${point}"></span>μ›

		<!-- β–¶ μ¶©μ „ν•κΈ° λ²„νΌ -->
		<a th:href="@{/point/chargePage(userId=${userId})}"> π’° ν¬μΈνΈ μ¶©μ „ν•λ¬
			κ°€κΈ° </a>
	</p>
	<table>
		<thead>
			<tr>
				<th>μμ•½λ²νΈ</th>
				<th>λ©΄μ ‘κ΄€ ID</th>
				<th>λ©΄μ ‘κ΄€ μ΄λ¦„</th>
				<th>μμ•½μΌμ‹</th>
				<th>μμ•½ν• λ‚ μ§</th>
				<th>μƒνƒ</th>
				<th>κ²°μ </th>
				<th>λ³€κ²½</th>
				<th>μ·¨μ†</th>
			</tr>
		</thead>
		<tbody>
			<tr th:if="${#lists.isEmpty(myReservations)}">
				<td colspan="7">μμ•½ λ‚΄μ—­μ΄ μ—†μµλ‹λ‹¤.</td>
			</tr>
			<tr th:each="r : ${myReservations}">
				<!-- PK -->
				<td th:text="${r.resId}">1</td>
				<!-- intrId κ°€ μ΄μ  String μ΄λ―€λ΅ .userIdκ°€ μ•„λ‹ λ°”λ΅ μ¶λ ¥ -->
				<td th:text="${r.intrId}">intr01</td>
				<!-- μ΄λ¦„μ΄ ν•„μ”ν•λ©΄ μ»¨νΈλ΅¤λ¬μ—μ„ MapμΌλ΅ λ„κ²¨μ£Όκ³  intrNames[r.intrId] λ΅ κΊΌλ‚΄μ„Έμ” -->
				<td th:text="${intrNames[r.intrId]}">λ©΄μ ‘κ΄€μ΄λ¦„</td>
				<!-- μμ•½μΌμ‹: reservedDate + reservedTime -->
				<td th:text="${r.reservedDate + ' ' + r.reservedTime}">
					2025-07-09 12:00</td>
				<!-- μƒμ„±μΌμ‹ -->
				<td th:text="${#dates.format(r.resCreateDt, 'yyyy-MM-dd HH:mm')}">
					2025-07-06 17:00</td>
				<!-- μƒνƒ ν‘μ‹ -->
				<td><span th:switch="${r.resStatus}"> <span
						th:case="'pending'"
						style="background: #ffeb3b; color: #333; padding: 2px 8px; border-radius: 4px;">
							κ²°μ  μ „ </span> <span th:case="'confirmed'"
						style="background: #4caf50; color: #fff; padding: 2px 8px; border-radius: 4px;">
							κ²°μ  μ™„λ£ </span> <span th:case="'cancelled'"
						style="background: #999; color: #fff; padding: 2px 8px; border-radius: 4px;">
							μ·¨μ†λ¨ </span> <span th:case="*"> μ• μ μ—†μ </span>
				</span></td>

				<!-- κ²°μ  λ²„νΌ/μ™„λ£ -->
				<td>
					<!-- μƒνƒκ°€ κ²°μ  μ „μΈ κ²½μ°λ§ ν‘μ‹ -->
					<div th:if="${r.resStatus == 'pending'}">
						<a th:href="@{/payment/charge(resId=${r.resId})}"
							style="color: blue;"> μΉ΄λ“κ²°μ </a><br />

						<!-- ν¬μΈνΈ κ²°μ  form -->
						<form th:action="@{/point/use}" method="post">
							<input type="hidden" name="userId" th:value="${userId}" /> <input
								type="hidden" name="amount" value="100" /> <input type="hidden"
								name="resId" th:value="${r.resId}" />
							<button type="submit">ν¬μΈνΈ κ²°μ </button>
						</form>

					</div>
					
					 <!-- λ³€κ²½ λ²„νΌ: μ·¨μ† μƒνƒκ°€ μ•„λ‹λ©΄ ν‘μ‹ -->
				<td><a th:if="${r.resStatus != 'cancelled'}"
					th:href="@{/reservation/edit(resId=${r.resId})}" class="button">
						λ³€κ²½ </a></td>
						
				<!--μ·¨μ†λ²„νΌ -->
				<td><a th:if="${r.resStatus != 'cancelled'}"
					th:href="@{/reservation/cancel(resId=${r.resId})}"
					onclick="return confirm('μ •λ§ μ΄ μμ•½μ„ μ·¨μ†ν•μ‹κ² μµλ‹κΉ?');"> μ·¨μ†ν•κΈ° </a></td>
			</tr>
		</tbody>
	</table>

	<p>
		<a href="/reservation/testlist">λ©λ΅μΌλ΅ λμ•„κ°€κΈ°</a>
	</p>
</body>
</html>
