<!-- src/main/resources/templates/mypage/memschedule.html -->
<div th:fragment="memschedule" class="reservation-list">
  <div class="content-card">
	<h2 class="reservation-title">λ‚΄ μμ•½ λ©λ΅</h2>

	<div class="reservation-summary">
		<span>λ³΄μ  ν¬μΈνΈ: <strong th:text="${point}">0</strong>μ›
		</span>
		<button th:onclick="'location.href=\'' + @{/point/chargePage(userId=${userId})} + '\''" class="btn-charge">
  π’° ν¬μΈνΈ μ¶©μ „ν•κΈ°
</button>

	<table class="reservation-table">
		<thead>
			<tr>
				<th>μμ•½λ²νΈ</th>
				<th>λ©΄μ ‘κ΄€ μ΄λ¦„</th>
				<th>μμ•½μΌμ‹</th>
				<th>μμ•½ν• λ‚ μ§</th>
				<th>μƒνƒ</th>
				<th>κ²°μ </th>
				<th>κ²°μ μλ‹¨</th>
				<th>λ°©μ •λ³΄</th>			<!-- ν„μ§„ μ¶”κ°€ -->
				<th>λ³€κ²½</th>
				<th>μ·¨μ†</th>
			</tr>
		</thead>
		<tbody>
			<tr th:if="${#lists.isEmpty(myReservations)}">
				<td colspan="8" class="no-data">μμ•½ λ‚΄μ—­μ΄ μ—†μµλ‹λ‹¤.</td>
			</tr>
			<tr th:each="r : ${myReservations}">
				<td th:text="${r.resId}">1</td>
				<td th:text="${intrNames[r.intrId]}">κΉ€λ©΄μ ‘</td>
				<td th:text="${r.reservedDate + ' ' + r.reservedTime}">2025-07-09
					12:00</td>
				<td th:text="${#dates.format(r.resCreateDt,'yyyy-MM-dd HH:mm')}">2025-07-06
					17:00</td>
				<td><span class="status"
					th:classappend="${r.resStatus=='pending'?'pending':r.resStatus=='confirmed'?'confirmed':r.resStatus=='cancelled'?'cancelled':''}"
					th:text="${r.resStatus=='pending'?'κ²°μ  μ „':r.resStatus=='confirmed'?'κ²°μ  μ™„λ£':r.resStatus=='cancelled'?'μ·¨μ†λ¨':'μ• μ μ—†μ'}">
				</span></td>
				<td>
					<div th:if="${r.resStatus=='pending'}" class="payment-actions">
						<button type="button" class="btn-pay btn-card"
							th:data-resid="${r.resId}">μΉ΄λ“κ²°μ </button>
						<form th:action="@{/point/use}" method="post" class="inline-form"
							onsubmit="return confirm('ν¬μΈνΈλ΅ κ²°μ ν•μ‹κ² μµλ‹κΉ?');">
							<input type="hidden" name="userId" th:value="${userId}" /> 
							<input type="hidden" name="amount" value="5000" /> 
							<input type="hidden" name="resId" th:value="${r.resId}" />
							<button type="submit" class="btn-pay btn-point">ν¬μΈνΈκ²°μ </button>
						</form>
					</div>
				</td>
				<td>
				<span th:if="${r.payment != null}"th:text="${r.payment.payType}">CARD</span> 
				<span th:if="${r.payment == null}">-</span></td>
				
				<!-- ν„μ§„ μ¶”κ°€ -->
				<td><a th:if="${r.resStatus!='cancelled'}" href="#" 
					th:attr="data-res-id=${r.resId}"
					class="action-link info">λ°©μ •λ³΄</a></td>
				<!-- λ -->
				<td><a th:if="${r.resStatus!='cancelled'}" href="#"
					class="action-link change">λ³€κ²½</a></td>
				<td><a th:if="${r.resStatus != 'cancelled'}"
					th:href="@{'/reservation/cancel?resId=' + ${r.resId}}"
					th:attr="data-res-id=${r.resId}" class="action-link cancel"> μ·¨μ†
				</a></td>

			</tr>
		</tbody>
	</table>

	<!-- μ¤μΌ€μ¤„λ¬ ν¨λ„ (κΈ°λ³Έμ€ μ¨κΉ€) -->
	<div id="schedulerPanel" class="scheduler-panel" style="display: none;">
		<div class="scheduler-inner">
			<div class="calendar-area">
				<h4>λ‚ μ§ μ„ νƒ</h4>
				<div id="calendarPicker"></div>
			</div>
			<div class="time-area">
				<h4>μ‹κ°„ μ„ νƒ</h4>
				<div class="time-buttons">
					<button type="button" data-time="09:00">09:00</button>
					<button type="button" data-time="10:00">10:00</button>
					<button type="button" data-time="11:00">11:00</button>
					<button type="button" data-time="12:00">12:00</button>
					<button type="button" data-time="13:00">13:00</button>
					<button type="button" data-time="14:00">14:00</button>
					<button type="button" data-time="15:00">15:00</button>
					<button type="button" data-time="16:00">16:00</button>
					<button type="button" data-time="17:00">17:00</button>
					<button type="button" data-time="18:00">18:00</button>
				</div>
			</div>
			<div class="info-area">
				<h4>λ‚΄ μμ•½ μ •λ³΄</h4>
				<p>
					μμ•½λ²νΈ: <strong id="infoResId"></strong>
				</p>
				<p>
					λ©΄μ ‘κ΄€: <strong id="infoIntrName"></strong>
				</p>
				<div class="action-buttons">
					<button id="saveChange" class="btn-save">μ €μ¥</button>
					<button id="cancelChange" class="btn-cancel">μ·¨μ†</button>
				</div>
			</div>
		</div>
	</div>
	
	<!-- ν„μ§„ μ¶”κ°€ -->
	<div id="schedulerInfoPanel" class="scheduler-info-panel" style="display: none;">
		<div class="scheduler-inner">
			<div class="info-area" style="margin-left: auto; width: 200px;">
				<h4>λ‚΄ μμ•½ μ •λ³΄</h4>
				<p>
					μμ•½λ²νΈ: <strong id="infoResIdRoom"></strong>
				</p>
				<p>
					λ©΄μ ‘κ΄€: <strong id="infoIntrNameRoom"></strong>
				</p>
				<p>
					λ°©μ λ©: <strong id="intrRoomTitle"></strong>
				</p>
				<p>
					λ°©λΉ„λ°€λ²νΈ: <strong id="intrRoomPw"></strong>
				</p>
				<div class="action-buttons">
					<button id="cancelInfo" class="btn-cancel">μ·¨μ†</button>
				</div>
			</div>
		</div>
	</div>

	

	<!-- reservedSlotsJson JSON λ°μ΄ν„° μ „λ‹¬ -->
	<script id="reservedSlotsJson" type="application/json"
		th:utext="${reservedSlotsJson}"></script>
</div>
</div>
</div>


